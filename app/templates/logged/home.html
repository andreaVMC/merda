{% extends "base.html" %}


{% block title %}
Your friends updates
{% endblock %}

{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/page.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
<!-- Font Awesome -->
<script src="https://kit.fontawesome.com/95ae55bd9a.js" crossorigin="anonymous"></script>
<!-- Material Icon -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<!-- jQuery 3.6.0 -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- new modal -->
<div id="new-modal" class="modal">
    <div class="modal-inner">
        <span class="btn text modal-close" onclick="closeModal('new-modal')">&times;</span>
        <div style="margin: 50px 0; width: min(100%, 600px); height: 100%;">
            <h2>Record new shit</h2>
            <form method="POST" action="{{ url_for('api.new_shit') }}" class="basic-form">
                {{ form.csrf_token }}
                <!-- Two-input container for time and rating fields -->
                <div class="two-inputs-container" style="grid-template-columns: 40% 60%;">
                    <div class="material-textfield">
                        {{ form.created_at(id='created_at', class_='datetime-local') }}
                        {{ form.created_at.label }}
                    </div>                    
                    <div class="rating-field">
                        <div class="feedback">
                            <div class="rating">
                                <input type="radio" name="level_of_satisfaction" id="rating-5" value="5">
                                <label for="rating-5"></label>
                                <input type="radio" name="level_of_satisfaction" id="rating-4" value="4">
                                <label for="rating-4"></label>
                                <input type="radio" name="level_of_satisfaction" id="rating-3" value="3">
                                <label for="rating-3"></label>
                                <input type="radio" name="level_of_satisfaction" id="rating-2" value="2">
                                <label for="rating-2"></label>
                                <input type="radio" name="level_of_satisfaction" id="rating-1" value="1">
                                <label for="rating-1"></label>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- More options button and script -->
                <div style="display: flex; padding-bottom: 50px;" id="more-change">
                    <button type="button" class="btn text" id="more-btn" style="width: 50%; position: absolute; left: 0;">More options</button>
                    <script>
                        $('#more-btn').click(function(event) {
                            event.preventDefault(); // Prevent the form from submitting
                            $('.more').slideToggle();
                            $('#more-btn').text(function(i, text){
                                return text === "More options" ? "Less options" : "More options";
                            });
                            $('#more-change').css('display', function(){
                                return $('#more-change').css('display') === 'flex' ? 'block' : 'flex';
                            });
                        });
                        // Set default value for created_at
                        document.addEventListener('DOMContentLoaded', (event) => {
                            const now = new Date();
                            const year = now.getFullYear();
                            const month = String(now.getMonth() + 1).padStart(2, '0');
                            const day = String(now.getDate()).padStart(2, '0');
                            const hours = String(now.getHours()).padStart(2, '0');
                            const minutes = String(now.getMinutes()).padStart(2, '0');
                            const formattedDateTime = `${year}-${month}-${day}T${hours}:${minutes}`;
                            document.getElementById('created_at').value = formattedDateTime;
                        });
                    </script>
                    <div class="more basic-form" style="display: none; margin: 50px 0 25px 0">
                        <div class="input-container">
                            <div class="select">
                                <select id="colorID" name="colorID" class="select-text">
                                    <option selected value="" style="display: none;" disabled></option>
                                    {% for value, label in form.colorID.choices %}
                                        <option value="{{ value }}">{{ label }}</option>
                                    {% endfor %}
                                </select>
                                <label for="colorID" class="select-label">{{ form.colorID.label.text }}</label>
                            </div>
                        </div>
                        <div class="input-container">
                            <div class="select">
                                <select class="select-text" id="shape" name="shape">
                                    <option selected value="" style="display: none;" disabled></option>
                                    {% for value, label in form.shape.choices %}
                                        <option value="{{ value }}">{{ label }}</option>
                                    {% endfor %}
                                </select>
                                <label for="shape" class="select-label">{{ form.shape.label.text }}</label>
                            </div>
                        </div>
                        <div class="two-inputs-container">
                            <div class="material-textfield">
                                {{ form.quantity.label }}
                                {{ form.quantity() }}
                            </div>
                            <div class="material-textfield">
                                {{ form.dimension.label }}
                                {{ form.dimension() }}
                            </div>
                        </div>
                        <div class="input-container">
                            <div class="material-textfield">
                                {{ form.notes() }}
                                {{ form.notes.label }}
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn filled" style="width: 50%; position: absolute; right: 0;">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="post-list">
    {% for shit, user, teams in shits %}
    <div class="post"> <!-- TODO post color depending on shit color -->
        <p class="username"><a href="/user/{{ user.id }}">{{ user.nickname }}</a></p>
        <!--p>
            Shape: 
            
            {% if shit.shape == 1 %}
                <img src="{{ url_for('static', filename='img/type1.png') }}" alt="Type 1">
            {% elif shit.shape == 2 %}
                <img src="{{ url_for('static', filename='img/type2.png') }}" alt="Type 2">
            {% elif shit.shape == 3 %}
                <img src="{{ url_for('static', filename='img/type3.png') }}" alt="Type 3">
            {% elif shit.shape == 4 %}
                <img src="{{ url_for('static', filename='img/type4.png') }}" alt="Type 4">
            {% elif shit.shape == 5 %}
                <img src="{{ url_for('static', filename='img/type5.png') }}" alt="Type 5">
            {% elif shit.shape == 6 %}
                <img src="{{ url_for('static', filename='img/type6.png') }}" alt="Type 6">
            {% elif shit.shape == 7 %}
                <img src="{{ url_for('static', filename='img/type7.png') }}" alt="Type 7">
            {% else %}
                <p>No image available for this shit shape.</p>
            {% endif %}
        </p-->
        <p>Level of Satisfaction: {{ shit.level_of_satisfaction }}</p> <!-- TODO: show satisfaction graphic -->
        <p>Timestamp: {{ shit.created_at }}</p> <!-- TODO format date time js -->
        <p class="shit-notes">Notes: {{ shit.notes }}</p>
        <p>Quantity: {{ shit.quantity }}</p>
        <p>Color ID: {{ shit.colorID }}</p>
        <p>Dimension: {{ shit.dimension }}</p>
        <p>
            Teams:
            {% if teams %}
                {% for team in teams %}
                    <a href="/team/{{ team.id }}" style="border:1px solid black">{{ team.name }}</a>
                {% endfor %}
            {% else %}
                No Team
            {% endif %}
    
        </p>
    </div>
    {% endfor %}
</div>
{% endblock %}