<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MERDA!</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/color.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/page.css') }}">
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/95ae55bd9a.js" crossorigin="anonymous"></script>
    <!-- Material Icon -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- jQuery 3.6.0 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <style>
        .shit-card {
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .shit-card h3 {
            margin-top: 0;
        }
        .user-info {
            color: #777;
            font-size: 14px;
        }
        .shit-notes {
            margin-top: 10px;
        }
    </style>
</head>
<body>

    {% include 'logged/includes/sidebar.html' %}
    
    {% include 'includes/flash.html' %}

    <div class="container mt-5">
        <h1 class="mb-4">{{user.nickname}}'s shit feed</h1>

        <!-- new modal -->
        <div id="new-modal" class="modal">
            <div class="modal-inner">
                <span class="btn text modal-close" onclick="closeModal('new-modal')">&times;</span>
                <h2>Record new shit</h2>
                <div style="margin: 25px; width: min(100%, 600px);">
                    <form method="POST" action="{{ url_for('new_shit') }}" class="basic-form">
                        {{ form.csrf_token }}

                        <!-- da aggiungere backend -->
                        <div class="two-inputs-container" style="grid-template-columns: 30% 70%;">

                            <div class="material-textfield">
                                <input type="time" name="time" placeholder="">
                                <label>Time</label>
                            </div>

                            <!--div class="material-textfield">
                                {{ form.level_of_satisfaction }}
                                {{ form.level_of_satisfaction.label }}
                            </div-->
                            <div class="rating-field">
                                <div class="feedback">
                                    <div class="rating">
                                    <input type="radio" name="rating" id="rating-5">
                                    <label for="rating-5"></label>
                                    <input type="radio" name="rating" id="rating-4">
                                    <label for="rating-4"></label>
                                    <input type="radio" name="rating" id="rating-3">
                                    <label for="rating-3"></label>
                                    <input type="radio" name="rating" id="rating-2">
                                    <label for="rating-2"></label>
                                    <input type="radio" name="rating" id="rating-1">
                                    <label for="rating-1"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

<!-- TODO fix center and overflow -->
                        <div style="display: flex;" id="more-change">

                            <button class="btn text" id="more-btn" style="width: 50%; position: absolute; left: 0;">More options</button>

                            <script>
                                $('#more-btn').click(function() {
                                    $('.more').slideToggle();
                                    $('#more-btn').text(function(i, text){
                                        return text === "More options" ? "Less options" : "More options";
                                    });
                                    $('#more-change').css('display', function(){
                                        return $('#more-change').css('display') === 'flex' ? 'block' : 'flex';
                                    });
                                });
                            </script>

                            <div class="more" style="display: none;">

                                <div style="height: 200px;"></div> <!-- temp -->

                                <div class="material-textfield">
                                    {{ form.shape }}
                                    {{ form.shape.label }}
                                </div>
                                <div class="material-textfield">
                                    {{ form.quantity }}
                                    {{ form.quantity.label }}
                                </div>
                                <div class="material-textfield">
                                    {{ form.colorID }}
                                    {{ form.colorID.label }}
                                </div>
                                <div class="material-textfield">
                                    {{ form.dimension }}
                                    {{ form.dimension.label }}
                                </div>
                                <div class="material-textfield">
                                    {{ form.notes }}
                                    {{ form.notes.label }}
                                </div>

                                <div style="height: 200px;"></div>

                            </div>
                            
                            <button type="submit" class="btn filled" style="width: 50%; position: absolute; right: 0;">Submit</button></div>

                            </div>
                    </form>
                </div>
            </div>
        </div>


<!-- TODO card bg color based on selected shit color -->

        <h2>How're your friends doing?</h2>
        <div class="shit-list">
            {% for shit, user in shits %}
            <div class="shit-card">
                <p>
                    Shape: 
                    
                    {% if shit.shape == 1 %}
                        <img src="{{ url_for('static', filename='img/type1.png') }}" alt="Type 1">
                    {% elif shit.shape == 2 %}
                        <img src="{{ url_for('static', filename='img/type2.png') }}" alt="Type 2">
                    {% elif shit.shape == 3 %}
                        <img src="{{ url_for('static', filename='img/type3.png') }}" alt="Type 3">
                    {% elif shit.shape == 4 %}
                        <img src="{{ url_for('static', filename='img/type4.png') }}" alt="Type 4">
                    {% elif shit.shape == 5 %}
                        <img src="{{ url_for('static', filename='img/type5.png') }}" alt="Type 5">
                    {% elif shit.shape == 6 %}
                        <img src="{{ url_for('static', filename='img/type6.png') }}" alt="Type 6">
                    {% elif shit.shape == 7 %}
                        <img src="{{ url_for('static', filename='img/type7.png') }}" alt="Type 7">
                    {% else %}
                        <p>No image available for this shit shape.</p>
                    {% endif %}
                </p>
                <p>Quantity: {{ shit.quantity }}</p>
                <p>Color ID: {{ shit.colorID }}</p>
                <p>Dimension: {{ shit.dimension }}</p>
                <p>Level of Satisfaction: {{ shit.level_of_satisfaction }}</p>
                <p>Timestamp: {{ shit.created_at }}</p> 
                <p class="user-info">User: {{ user.nickname }} ({{ user.email }})</p>
                <p class="shit-notes">Notes: {{ shit.notes }}</p>
            </div>
        {% endfor %}
        </div>
    </div>
</body>
</html>
